<!doctype html><html><head><title>Install Latest Maxmind Database Into Maven Repository Using Thor</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><link rel=icon href=/images/favicon.ico><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css integrity=sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3 crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css><style type=text/css>html,body{height:100%;padding-top:30px;padding-bottom:40px}.sidebar-nav{padding-left:18px}.navbar-right{padding-right:18px}#wrap{min-height:100%;height:auto!important;height:100%;margin:0 auto 0}#push,#footer{height:60px}#footer{background-color:#f5f5f5}.white,.white a{color:#fff}</style></head><body><div id=wrap><div class=container-fluid><div class=container><h1 class=mt-5>Install Latest Maxmind Database Into Maven Repository Using Thor</h1><p class="text-muted mt-3"><a class=text-muted href=https://angstrom.io/2013/05/04/install-latest-maxmind-database-into-maven-repository-using-thor/>Published May 4, 2013</a>
<a class=text-muted href=/tags/maven>#maven</a>
<a class=text-muted href=/tags/thor>#thor</a>
<a class=text-muted href=/tags/maxmind>#maxmind</a></p><article class="article mt-5"><p>In a previous life, my company used the <a href=https://www.maxmind.com/en/home>MaxMind</a> GeoIP database for geo-location information based on client IP addresses. We packaged the .dat as a JAR included on the classpath for use in instantiating a <a href=https://github.com/maxmind/geoip-api-java/blob/master/source/com/maxmind/geoip/LookupService.java>com.maxmind.geoip.LookupService</a> object which we wrapped with a custom service.</p><p>Generally, we updated the database once a quarter so I wrote a <a href=https://github.com/wycats/thor>Thor</a> script to download the .dat file, put it into a JAR, and upload the JAR as a Maven artifact to a Maven-compatible repository (we used <a href=https://www.sonatype.org/nexus/>Nexus</a>). The default download location is <code>~/Downloads</code> but it&rsquo;s configurable via the passed in &rsquo;temp&rsquo; argument: <code>--temp=/tmp</code>.</p><h4 id=thor-file>Thor File</h4><div class=row><div class=col-md-10><script src=https://gist.github.com/cacoco/5518012.js></script></div></div><p>We used an <a href=https://en.wikipedia.org/wiki/ISO_8601>ISO 8601</a> timestamp as the version, i.e., <em>2011-02-25</em>.</p><h4 id=including-as-a-maven-dependency>Including as a Maven dependency</h4><div class=row><div class=col-md-8><script src=https://gist.github.com/cacoco/5518076.js></script></div></div><p>By including as a Maven dependency the JAR will be on the classpath and access to the .dat file can happen as a classpath resource.</p><h4 id=loading-the-file>Loading the File</h4><p>Most of our applications were written in Java using <a href=https://www.springsource.org/documentation>Spring</a> for dependency injection. We wrapped the <code>com.maxmind.geoip.LookupService</code> in a thin layer of our own code to provide our applications with a simple interface. To do this we made our service inherit from Spring&rsquo;s ApplicationContextAware Interface and override the <code>setApplicationContext(..)</code> method like such:</p><div class=row><div class=col-md-10><script src=https://gist.github.com/cacoco/5518218.js></script></div></div></article></div><div id=push></div><div id=push></div><div class="bg-light py-5"><div class=container><div class=row><div class="col-md-6 text-center"><a class=pull-left href=/2013/04/12/be-a-warning/ title="Be a Warning">&#171; Be a Warning</a></div><div class="col-md-6 text-center"><a class=pull-right href=/2013/11/03/devils-dictionary-of-programming/ title="Next Post: Devils Dictionary of Programming">Devils Dictionary of Programming &#187;</a></div></div></div></div></div><div id=push></div></div></body></html>